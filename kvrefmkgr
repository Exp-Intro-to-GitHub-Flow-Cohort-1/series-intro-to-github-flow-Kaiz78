f,fjfjf









def oldRev  = sh(script: 'git reflog -n 3 --pretty=%H | tail -n 1', returnStdout: true).trim()
def newRev  = sh(script: 'git reflog -n 1 --pretty=%H | tail -n 1', returnStdout: true).trim()


def commitCount = sh(script: "git rev-list --count ${oldRev}..${newRev}", returnStdout: true).trim()


// Initialiser une variable pour stocker les fichiers supprimés
def deletedFiles = []

// Boucle sur le nombre de commits récupérés et collecte les fichiers supprimés
for (int i = 0; i <= commitCount.toInteger(); i++) {
    def files = sh(script: "git diff --diff-filter=D --name-only HEAD~${i}", returnStdout: true).trim().split('\n')
    deletedFiles.addAll(files)
}

// Supprimer les entrées vides
deletedFiles = deletedFiles.findAll { it }


// Afficher les fichiers supprimés
echo "Fichiers supprimés : ${deletedFiles.join(', ')}"


// Stocker les fichiers supprimés dans une variable d'environnement
env.DELETED_FILES = deletedFiles.join(' ')


